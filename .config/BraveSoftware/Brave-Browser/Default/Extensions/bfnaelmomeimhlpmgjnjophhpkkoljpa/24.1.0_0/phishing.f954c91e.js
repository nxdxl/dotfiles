(function(define){var __define;"function"==typeof define&&define.amd&&(__define=define,define=null);
function e(e,t,n,o){Object.defineProperty(e,t,{get:n,set:o,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},i={},r=n.parcelRequire1d24;null==r&&((r=function(e){if(e in o)return o[e].exports;if(e in i){var t=i[e];delete i[e];var n={id:e,exports:{}};return o[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){i[e]=t},n.parcelRequire1d24=r),r.register("SH3Wm",(function(e,t){!function(){var n;try{n="undefined"!=typeof Intl&&void 0!==Intl.Collator?Intl.Collator("generic",{sensitivity:"base"}):null}catch(e){console.log("Collator could not be initialized and wouldn't be used")}var o=r("g1rEU"),i=[],l=[],a={get:function(e,t,r){if(r&&n&&r.useCollator){var a,s,c,d,u,f,h=e.length,m=t.length;if(0===h)return m;if(0===m)return h;for(c=0;c<m;++c)i[c]=c,l[c]=t.charCodeAt(c);for(i[m]=m,c=0;c<h;++c){for(s=c+1,d=0;d<m;++d)a=s,f=0===n.compare(e.charAt(c),String.fromCharCode(l[d])),(s=i[d]+(f?0:1))>(u=a+1)&&(s=u),s>(u=i[d+1]+1)&&(s=u),i[d]=a;i[d]=s}return s}return o.distance(e,t)}};"undefined"!=typeof define&&null!==define&&define.amd?define((function(){return a})):null!==e&&e.exports===t?e.exports=a:"undefined"!=typeof self&&"function"==typeof self.postMessage&&"function"==typeof self.importScripts?self.Levenshtein=a:"undefined"!=typeof window&&null!==window&&(window.Levenshtein=a)}()})),r.register("g1rEU",(function(t,n){e(t.exports,"distance",(function(){return i})),e(t.exports,"closest",(function(){return r}));const o=new Uint32Array(65536),i=(e,t)=>{if(e.length<t.length){const n=t;t=e,e=n}return 0===t.length?e.length:e.length<=32?((e,t)=>{const n=e.length,i=t.length,r=1<<n-1;let l=-1,a=0,s=n,c=n;for(;c--;)o[e.charCodeAt(c)]|=1<<c;for(c=0;c<i;c++){let e=o[t.charCodeAt(c)];const n=e|a;e|=(e&l)+l^l,a|=~(e|l),l&=e,a&r&&s++,l&r&&s--,a=a<<1|1,l=l<<1|~(n|a),a&=n}for(c=n;c--;)o[e.charCodeAt(c)]=0;return s})(e,t):((e,t)=>{const n=t.length,i=e.length,r=[],l=[],a=Math.ceil(n/32),s=Math.ceil(i/32);for(let e=0;e<a;e++)l[e]=-1,r[e]=0;let c=0;for(;c<s-1;c++){let a=0,s=-1;const d=32*c,u=Math.min(32,i)+d;for(let t=d;t<u;t++)o[e.charCodeAt(t)]|=1<<t;for(let e=0;e<n;e++){const n=o[t.charCodeAt(e)],i=l[e/32|0]>>>e&1,c=r[e/32|0]>>>e&1,d=n|a,u=((n|c)&s)+s^s|n|c;let f=a|~(u|s),h=s&u;f>>>31^i&&(l[e/32|0]^=1<<e),h>>>31^c&&(r[e/32|0]^=1<<e),f=f<<1|i,h=h<<1|c,s=h|~(d|f),a=f&d}for(let t=d;t<u;t++)o[e.charCodeAt(t)]=0}let d=0,u=-1;const f=32*c,h=Math.min(32,i-f)+f;for(let t=f;t<h;t++)o[e.charCodeAt(t)]|=1<<t;let m=i;for(let e=0;e<n;e++){const n=o[t.charCodeAt(e)],a=l[e/32|0]>>>e&1,s=r[e/32|0]>>>e&1,c=n|d,f=((n|s)&u)+u^u|n|s;let h=d|~(f|u),y=u&f;m+=h>>>i-1&1,m-=y>>>i-1&1,h>>>31^a&&(l[e/32|0]^=1<<e),y>>>31^s&&(r[e/32|0]^=1<<e),h=h<<1|a,y=y<<1|s,u=y|~(c|h),d=h&c}for(let t=f;t<h;t++)o[e.charCodeAt(t)]=0;return m})(e,t)},r=(e,t)=>{let n=1/0,o=0;for(let r=0;r<t.length;r++){const l=i(e,t[r]);l<n&&(n=l,o=r)}return t[o]}}));var l=r("lDSNw");r("1KK14");var a=r("4yY1D"),s=r("dU2RF"),c=r("cZIbv"),d=(r("lDSNw"),r("aJuCi")),u=r("kBpKb"),f={};e(f,"BlocklistOrigin",(function(){return ae}),(function(e){return ae=e}));var h=r("lMzyG"),m=r("1uUV4"),y=(l=r("lDSNw"),r("NQvFB")),g={};e(g,"removeSubdomainFromDomain",(function(){return j}),(function(e){return j=e})),e(g,"detectPhishing",(function(){return Z}),(function(e){return Z=e}));var p,b,w,S,v=r("6656F"),z={},k=(C=r("6rT8n")).Buffer;p=r("cfhP8"),b=r("grzf1").utf8,w=r("grzf1").bin,(S=function(e,t){var n=p.wordsToBytes(function(e){e.constructor==String?e=b.stringToBytes(e):void 0!==k&&"function"==typeof k.isBuffer&&k.isBuffer(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());var t=p.bytesToWords(e),n=8*e.length,o=[],i=1732584193,r=-271733879,l=-1732584194,a=271733878,s=-1009589776;t[n>>5]|=128<<24-n%32,t[15+(n+64>>>9<<4)]=n;for(var c=0;c<t.length;c+=16){for(var d=i,u=r,f=l,h=a,m=s,y=0;y<80;y++){if(y<16)o[y]=t[c+y];else{var g=o[y-3]^o[y-8]^o[y-14]^o[y-16];o[y]=g<<1|g>>>31}var w=(i<<5|i>>>27)+s+(o[y]>>>0)+(y<20?1518500249+(r&l|~r&a):y<40?1859775393+(r^l^a):y<60?(r&l|r&a|l&a)-1894007588:(r^l^a)-899497514);s=a,a=l,l=r<<30|r>>>2,r=i,i=w}i+=d,r+=u,l+=f,a+=h,s+=m}return[i,r,l,a,s]}(e));return t&&t.asBytes?n:t&&t.asString?w.bytesToString(n):p.bytesToHex(n)})._blocksize=16,S._digestsize=20,z=S;var C=r("6rT8n"),D=(e=>(e.BLOCK="BLOCK",e.NONE="NONE",e))(D||{});function B(e,n){for(let o=0;o<e.k;o++){const i=t(z)(`${e.salt}_${n}_${o}`,{asBytes:!0}),r=C.Buffer.from(i).subarray(0,4).readUInt32BE(0)%e.bits,l=Math.floor(r/24),a=r%24,s=a%8;if(0==(C.Buffer.from(e.bitVector.slice(4*l,4*l+4),"base64")[Math.floor(a/8)]&1<<7-s))return!1}return!0}var O,F;"undefined"!=typeof self&&self.fetch&&self.fetch;function L(e,t,n,o){const i=new URL(o).hostname.toLowerCase().split(".");for(let o=0;o<i.length-1;o++){const r=i.slice(o).join(".");if(t.includes(r))return"BLOCK";if(B(e,r)&&!n.includes(r))return"BLOCK"}return"NONE"}var R,U=JSON.parse('{"name":"@phantom-labs/blocklist","version":"0.13.0","main":"index.js","types":"index.d.ts","repository":"git@github.com:phantom-labs/blocklist.git","author":"Jordan Leigh <AlwaysBCoding@gmail.com>","license":"MIT","scripts":{"build":"node build.js"},"dependencies":{"js-yaml":"^4.1.0","sha3":"^2.1.4"}}').version;R=JSON.parse('{"blocklist":["phantomweb.app","aurory.app","solvision.io","staratlas.art","starsatlas.com","sollet.cc","raydlum.io","aurorynft.com","sneks.gg","solletweb.io","i-sollet.com","fancyfrenchienft.art","solanawebwallet.online","phahtom.com","server-syncwallet.com","staratias.app","raydium.network","grapesnetwork.me","staratias.art","soistarter.org","audius-nft.top","aurory.me","degenapes.app","phantom-app.online","phantomwallet.net","dapps-node.com","phantom-app.link","solanaoutage.com","walletconnectdapps.net","staratlas.cx","web-phantom.app","0120tt.com"],"whitelist":[],"fuzzylist":[],"contentHash":"830ea1c9a833213eabc17990adf053081f503b1203ca9a2c711db7199e657293"}');O=()=>U,F=()=>R;var x=r("8kIyR"),K=(m=r("1uUV4"),r("4y59b")),T=r("SH3Wm"),A=r("7pPsM"),E=(y=r("NQvFB"),r("6R6dI")),N=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function l(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((o=o.apply(e,t||[])).next())}))};const I=6e5,W=(A.z.object({type:A.z.union([A.z.literal("all"),A.z.literal("blocklist"),A.z.literal("whitelist"),A.z.literal("error"),A.z.literal("fuzzy"),A.z.literal("blowfishBloomFilter")]),result:A.z.boolean(),source:A.z.optional(A.z.string()),match:A.z.string().optional(),isSubdomainDomainWhitelisted:A.z.boolean().optional()}),A.z.object({localHash:A.z.any()}),A.z.object({bitVector:A.z.string(),k:A.z.number(),hash:A.z.string(),bits:A.z.number(),salt:A.z.string()})),H=A.z.union([A.z.object({bloomFilter:W,bloomFilterHash:A.z.string(),recentlyAdded:A.z.array(A.z.string()),recentlyRemoved:A.z.array(A.z.string())}),A.z.object({bloomFilter:W.optional(),bloomFilterHash:A.z.optional(A.z.string()),recentlyAdded:A.z.array(A.z.string()),recentlyRemoved:A.z.array(A.z.string())})]),_=A.z.object({bloomFilter:W,lastUpdated:A.z.number()}).nullish(),M=A.z.object({recentlyAdded:A.z.array(A.z.string()),recentlyRemoved:A.z.array(A.z.string()),lastUpdated:A.z.number().optional()}).nullish();class P{check(e,n,o){if(!e)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};const i=j(e),r=V(i);if(Q(r,this.whitelist)){const t=new URL(e).hostname;if(G(V(t),this.blocklist)){const e={type:"blocklist",result:!0,source:t,isSubdomainDomainWhitelisted:!0};return n&&o.capture("blockedDomain",{data:e}),e}return{type:"whitelist",result:!1,source:t,isSubdomainDomainWhitelisted:!0}}if(G(r,this.whitelist))return{type:"whitelist",result:!1,source:i,isSubdomainDomainWhitelisted:!1};if(G(r,this.blocklist)){const e={type:"blocklist",result:!0,source:i,isSubdomainDomainWhitelisted:!1};return n&&o.capture("blockedDomain",{data:e}),e}if(this.tolerance>0){let e=q(r);e=e.replace("www.","");const n=this.fuzzylist.find((n=>{const o=q(n);return t(T).get(e,o)<=this.tolerance}));if(n){return{type:"fuzzy",result:!0,match:$(n),source:i,isSubdomainDomainWhitelisted:!1}}}return{type:"all",result:!1,source:i,isSubdomainDomainWhitelisted:!1}}constructor(e,t,n,o){this.blocklist=J(e),this.whitelist=J(t),this.fuzzylist=J(n),this.tolerance=o||3}}const j=e=>{const t=new URL(e).hostname.split(".");return t.slice(0).slice(-(4===t.length?3:2)).join(".")},J=e=>e.map(V),V=e=>e.split(".").reverse(),$=e=>e.slice().reverse().join("."),q=e=>e.slice(1).reverse().join("."),G=(e,t)=>t.some((t=>!(t.length>e.length)&&t.every(((t,n)=>e[n]===t)))),Q=(e,t)=>t.some((t=>t[0]===e[0]&&t[1]===e[1]&&"*"===t[2])),Z=(e,t,n)=>N(void 0,void 0,void 0,(function*(){const o=F(),i=yield(0,E.getStorageValue)(m.StorageKeys.CachedBlocklistDiff),r=JSON.parse(`${i}`);let l,a,s,c;try{const e=yield(0,K.withTimeout)(t.getFeatureFlags(),1e3);l=!!e["kill-blowfish-blocklist"],a=!!e["enable-blocklist-metrics"],s=!!e["enable-blocklist-blowfish-logonly"],c=!!e["enable-http-wrapper"]}catch(e){l=!1,a=!0,s=!0,c=!1}if(r&&r.expiresAt&&r.expiresAt>Date.now()){const i=new P(o.blocklist.concat(r.blocklist),o.whitelist.concat(r.whitelist),o.fuzzylist.concat(r.fuzzylist)).check(n,a,t);return"all"!==i.type||l?i:Y(n,a,s,c,e,t)}{const i=new Headers,d=O();r&&i.append("lastContentHash",`${r.contentHash}`),d&&i.append("localBlocklistVersion",`${d}`);const u=yield fetch(y.PHANTOM_BLOCKLIST_URL,{headers:i});if(200===u.status){const i=yield u.json();i.expiresAt=Date.now()+I,(0,E.setStorageValue)(m.StorageKeys.CachedBlocklistDiff,JSON.stringify(i));const r=new P(o.blocklist.concat(i.blocklist),o.whitelist.concat(i.whitelist),o.fuzzylist.concat(i.fuzzylist)).check(n,a,t);return"all"!=r.type||l?r:Y(n,a,s,c,e,t)}if(304===u.status){r.expiresAt=Date.now()+I,(0,E.setStorageValue)(m.StorageKeys.CachedBlocklistDiff,JSON.stringify(r));const i=new P(o.blocklist.concat(r.blocklist),o.whitelist.concat(r.whitelist),o.fuzzylist.concat(r.fuzzylist)).check(n,a,t);return"all"!=i.type||l?i:Y(n,a,s,c,e,t)}return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}}})),Y=(e,t,n,o,i,r)=>N(void 0,void 0,void 0,(function*(){var l,a,s;if(!e)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};const c=j(e),d=yield i.getAll([m.StorageKeys.CachedBloomFilter,m.StorageKeys.CachedBloomFilterHash,m.StorageKeys.CachedScanDataRecents]),u=null!==(l=d[m.StorageKeys.CachedBloomFilter])&&void 0!==l?l:null,f=null!==(a=d[m.StorageKeys.CachedBloomFilterHash])&&void 0!==a?a:null,h=null!==(s=d[m.StorageKeys.CachedScanDataRecents])&&void 0!==s?s:null;let g=null,p={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0};if(u){const e=_.safeParse(u);e.success?g=e.data:yield i.remove([m.StorageKeys.CachedBloomFilter,m.StorageKeys.CachedBloomFilterHash,m.StorageKeys.CachedScanDataRecents])}if(h){const e=M.safeParse(h);e.success?p=e.data:yield i.remove([m.StorageKeys.CachedBloomFilter,m.StorageKeys.CachedBloomFilterHash,m.StorageKeys.CachedScanDataRecents])}if(!p||null==p.lastUpdated||Date.now()>p.lastUpdated+I){const e={localHash:f};let t,n;if(o){const n=new(0,x.RequestClient)(!0),o=yield n.post(y.BLOWFISH_BLOOMFILTER_URL,e);if(200!==o.status)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};t=o.data}else{const n=yield fetch(y.BLOWFISH_BLOOMFILTER_URL,{method:"POST",body:JSON.stringify(e)});if(200!==n.status)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};t=yield n.json()}const r=H.safeParse(t);if(!r.success)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};n=r.data;const l={recentlyAdded:n.recentlyAdded,recentlyRemoved:n.recentlyRemoved,lastUpdated:Date.now()};if(yield i.set(m.StorageKeys.CachedScanDataRecents,l),p=l,null!=n.bloomFilter){const e={bloomFilter:n.bloomFilter,lastUpdated:Date.now()};yield Promise.all([i.set(m.StorageKeys.CachedBloomFilter,e),i.set(m.StorageKeys.CachedBloomFilterHash,n.bloomFilterHash)]),g=e}}if(!g)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};const b=L(g.bloomFilter,p.recentlyAdded,p.recentlyRemoved,e);if(b===D.BLOCK){const e={result:!0,source:c,type:"blowfishBloomFilter"};return t&&r.capture("blockedDomain",{data:e}),n?{result:!1,type:"all",isSubdomainDomainWhitelisted:!1}:e}return b===D.NONE?{result:!1,type:"all",isSubdomainDomainWhitelisted:!1}:{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}}));E=r("6R6dI"),c=r("cZIbv");var X=r("aanFI"),ee=r("kn91D"),te=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function l(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((o=o.apply(e,t||[])).next())}))};const ne="#ca3214",oe=c.default.div`
  position: fixed;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  background-color: #fffdf8;
  padding: clamp(24px, 16vh, 256px) 24px;
  box-sizing: border-box;
`,ie=c.default.div`
  margin-bottom: 24px;
  padding-bottom: 8vh;
`,re=c.default.div`
  max-width: 100ch;
  margin: auto;

  * {
    text-align: left;
  }
`,le=c.default.a`
  text-decoration: underline;
  color: ${ne};
`,ae=({origin:e,subdomain:n})=>{const{t:o}=(0,h.useTranslation)(),i=e?(0,g.removeSubdomainFromDomain)(e):"",r=new URL(null!=e?e:"").hostname,a="true"===n?r:i;return t(l).createElement(oe,null,t(l).createElement(re,null,t(l).createElement(ie,null,t(l).createElement(X.IconPhantomWordmark,{width:128,fill:"#bbb9b6"})),t(l).createElement(ee.Text,{size:30,color:ne,weight:"600"},o("blocklistOriginDomainIsBlocked",{domainName:a||o("blocklistOriginThisDomain")})),t(l).createElement(ee.Text,{color:ne},o("blocklistOriginSiteIsMalicious")),t(l).createElement(ee.Text,{color:ne},t(l).createElement(h.Trans,{i18nKey:"blocklistOriginCommunityDatabaseInterpolated"},"This site has been flagged as part of a",t(l).createElement(le,{href:y.PHANTOM_BLOCKLIST_GITHUB_URL,rel:"noopener",target:"_blank"},"community-maintained database"),"of known phishing websites and scams. If you believe the site has been flagged in error,",t(l).createElement(le,{href:y.PHANTOM_BLOCKLIST_GITHUB_URL,rel:"noopener",target:"_blank"},"please file an issue"),".")),a?t(l).createElement(ee.Text,{color:ne,onClick:()=>te(void 0,void 0,void 0,(function*(){if("true"===n){const e=yield(0,E.getStorageValue)(m.StorageKeys.UserWhitelistSubdomains);let t=JSON.parse(`${e}`);t?t.push(r):t=[r],t=[...new Set(t)],(0,E.setStorageValue)(m.StorageKeys.UserWhitelistSubdomains,JSON.stringify(t))}else{const e=yield(0,E.getStorageValue)(m.StorageKeys.UserWhitelistedOrigins);let t=JSON.parse(`${e}`);t?t.push(i):t=[i],t=[...new Set(t)],(0,E.setStorageValue)(m.StorageKeys.UserWhitelistedOrigins,JSON.stringify(t))}window.location.href=e})),hoverUnderline:!0},o("blocklistOriginIgnoreWarning",{domainName:e})):t(l).createElement(t(l).Fragment,null)))},se=()=>{let e;try{e=new URLSearchParams(window.location.search).get("origin")||"",new URL(e)}catch(t){e=""}return e},ce=()=>new URLSearchParams(window.location.search).get("subdomain")||"";var de=r("a8kcR"),ue=r("h5kyv"),fe=r("8DCD7"),he=r("1wI6a");a.fileLogger.init({provider:he.FileLoggerProvider}),a.telemetry.init(),a.telemetry.setUser({id:ue.analytics.getDeviceId()}),(0,fe.initializeFeatureFlags)();const me=document.getElementById("root");(0,s.createRoot)(me).render(t(l).createElement(c.ThemeProvider,{theme:de.theme},t(l).createElement((()=>{const e=(0,l.useMemo)(se,[]),n=(0,l.useMemo)(ce,[]);return t(l).createElement(d.MemoryRouter,{future:{v7_startTransition:!0}},t(l).createElement(u.ErrorBoundaryWithDefaultFallback,null,t(l).createElement(f.BlocklistOrigin,{origin:e,subdomain:n})))}),null)));
//# sourceMappingURL=phishing.f954c91e.js.map
define=__define;})(window.define);